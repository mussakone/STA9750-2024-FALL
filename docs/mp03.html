<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Mussa Kone">

<title>This Is My Mini Project #3: Electoral College System and Presidential Elections – STA 9750 2024 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 2024 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">This Is My Mini Project #3: Electoral College System and Presidential Elections</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Mussa Kone </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
</section>
<section id="section" class="level1">
<h1></h1>
<p>This project explores how the outcomes of U.S. presidential elections might have changed under different electoral allocation rules, using historical congressional election data. While this type of retrospective analysis, or “retrodiction,” has inherent limitations, it offers a unique way to examine potential biases in the electoral college system.It’s important to note that if these rules had actually been in place, candidates may have campaigned differently, which could have affected vote counts.</p>
<p>For this analysis,I will examine a claim by Senator Elizabeth Warren, who has stated that the Electoral College “disadvantages voters in heavily populated states” and results in an “undemocratic” election outcome. The final goal of this analysis is to create a “Fact Check” style report. This project will analyze the results of presidential elections under different allocation methods to evaluate the existence of such bias, summarize findings based on this analysis, and provide a “truthfulness” score for Senator Warren’s claim, using the PolitiFact Truth-O-Meter scale: “True” “Mostly True,” “Half True,” “Mostly False,” or “False.”</p>
<p>First, the necessary data from the The MIT Election Data Science Lab that collects votes from all biennial congressional races in all 50 states will be downloaded, as well as the statewide presidential vote counts from 1976 to 2022.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the path to the Downloads folder</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data_dir <span class="ot">&lt;-</span> <span class="st">"~/Downloads"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the 1976-2022 congressional data file</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>house_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"1976-2022-house.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 32452 Columns: 20
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (7): state, state_po, office, stage, candidate, party, mode
dbl (8): year, state_fips, state_cen, state_ic, district, candidatevotes, to...
lgl (5): runoff, special, writein, unofficial, fusion_ticket

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the sources-president data file</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>president_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"sources-president.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 51 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): State, Source, Is certified?, notes
lgl (1): missing votes?

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preview both datasets to confirm they loaded correctly</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(house_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 20
   year state   state_po state_fips state_cen state_ic office   district stage
  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;
1  1976 ALABAMA AL                1        63       41 US HOUSE        1 GEN  
2  1976 ALABAMA AL                1        63       41 US HOUSE        1 GEN  
3  1976 ALABAMA AL                1        63       41 US HOUSE        1 GEN  
4  1976 ALABAMA AL                1        63       41 US HOUSE        2 GEN  
5  1976 ALABAMA AL                1        63       41 US HOUSE        2 GEN  
6  1976 ALABAMA AL                1        63       41 US HOUSE        2 GEN  
# ℹ 11 more variables: runoff &lt;lgl&gt;, special &lt;lgl&gt;, candidate &lt;chr&gt;,
#   party &lt;chr&gt;, writein &lt;lgl&gt;, mode &lt;chr&gt;, candidatevotes &lt;dbl&gt;,
#   totalvotes &lt;dbl&gt;, unofficial &lt;lgl&gt;, version &lt;dbl&gt;, fusion_ticket &lt;lgl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(president_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  State Source                            `Is certified?` notes `missing votes?`
  &lt;chr&gt; &lt;chr&gt;                             &lt;chr&gt;           &lt;chr&gt; &lt;lgl&gt;           
1 AK    https://www.elections.alaska.gov… yes             &lt;NA&gt;  NA              
2 AL    https://www.sos.alabama.gov/site… yes             fina… NA              
3 AR    https://results.enr.clarityelect… official        scyt… TRUE            
4 AZ    https://azsos.gov/node/1251       official        &lt;NA&gt;  NA              
5 CA    https://www.sos.ca.gov/elections… official        &lt;NA&gt;  NA              
6 CO    https://www.sos.state.co.us/pubs… official        &lt;NA&gt;  TRUE            </code></pre>
</div>
</div>
<section id="task-1-download-congressional-shapefiles-1976-2012" class="level2">
<h2 class="anchored" data-anchor-id="task-1-download-congressional-shapefiles-1976-2012">Task 1: Download Congressional Shapefiles 1976-2012</h2>
<p>In this task, we aim to automate the process of downloading U.S. congressional district shapefiles for each Congress from 1976 to 2012. These shapefiles, provided by Lewis et al., allow us to visualize and analyze geographic boundaries that define congressional districts over time.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)    <span class="co"># For HTTP requests</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)    <span class="co"># For formatted strings</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)      <span class="co"># For file and directory handling</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up directory for shapefiles</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>download_dir <span class="ot">&lt;-</span> <span class="st">"data/shapefiles"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir_exists</span>(download_dir)) <span class="fu">dir_create</span>(download_dir)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define base URL and range of Congress sessions</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://cdmaps.polisci.ucla.edu/shp/districts"</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>congress_years <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">94</span>, <span class="dv">112</span>)  <span class="co"># Congresses from 1976 to 2012 (94th to 112th)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through Congress sessions to download shapefiles</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (congress <span class="cf">in</span> congress_years) {</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define file name and path</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  zip_file_name <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"c{congress}_dist.zip"</span>)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  zip_file_path <span class="ot">&lt;-</span> <span class="fu">path</span>(download_dir, zip_file_name)</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Download only if the file does not already exist</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file_exists</span>(zip_file_path)) {</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Construct the download URL</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    download_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{base_url}/{zip_file_name}"</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try downloading the file</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Attempting to download:"</span>, download_url, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    response <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">GET</span>(download_url, <span class="fu">write_disk</span>(zip_file_path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Error downloading:"</span>, zip_file_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NULL</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the download was successful</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(response) <span class="sc">&amp;&amp;</span> <span class="fu">status_code</span>(response) <span class="sc">==</span> <span class="dv">200</span>) {</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Downloaded:"</span>, zip_file_name, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Extract .shp files from the zip file if download successful</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>      extracted_dir <span class="ot">&lt;-</span> <span class="fu">path</span>(download_dir, <span class="fu">glue</span>(<span class="st">"congress_{congress}"</span>))</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir_exists</span>(extracted_dir)) <span class="fu">dir_create</span>(extracted_dir)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Unzip only the .shp files</span></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>      shp_files <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.shp$"</span>, <span class="fu">unzip</span>(zip_file_path, <span class="at">list =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>Name, <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unzip</span>(zip_file_path, <span class="at">files =</span> shp_files, <span class="at">exdir =</span> extracted_dir)</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Extracted shapefiles for Congress"</span>, congress, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"File already exists:"</span>, zip_file_name, <span class="st">"- Skipping download.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>File already exists: c94_dist.zip - Skipping download.
File already exists: c95_dist.zip - Skipping download.
File already exists: c96_dist.zip - Skipping download.
File already exists: c97_dist.zip - Skipping download.
File already exists: c98_dist.zip - Skipping download.
File already exists: c99_dist.zip - Skipping download.
File already exists: c100_dist.zip - Skipping download.
File already exists: c101_dist.zip - Skipping download.
File already exists: c102_dist.zip - Skipping download.
File already exists: c103_dist.zip - Skipping download.
File already exists: c104_dist.zip - Skipping download.
File already exists: c105_dist.zip - Skipping download.
File already exists: c106_dist.zip - Skipping download.
File already exists: c107_dist.zip - Skipping download.
File already exists: c108_dist.zip - Skipping download.
File already exists: c109_dist.zip - Skipping download.
File already exists: c110_dist.zip - Skipping download.
File already exists: c111_dist.zip - Skipping download.
File already exists: c112_dist.zip - Skipping download.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"All shapefiles processed successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>All shapefiles processed successfully.</code></pre>
</div>
</div>
</section>
<section id="task-2-automated-download-of-congressional-shapefiles-2014-2022" class="level2">
<h2 class="anchored" data-anchor-id="task-2-automated-download-of-congressional-shapefiles-2014-2022">Task 2: Automated Download of Congressional Shapefiles (2014-2022)</h2>
<p>In this task, we aim to automate the process of downloading congressional district shapefiles for each U.S. Congress from 2014 to 2022. These shapefiles, available from the U.S. Census Bureau, provide geographical boundary data for congressional districts, which is crucial for spatial analysis and mapping of political and demographic trends. Additionally, we will extract only the necessary <code>.shp</code> files from each downloaded zip archive, organizing them with a clear naming convention for easy reference in future analysis. This structured approach will facilitate accurate and reproducible results for any subsequent spatial analyses or visualizations involving U.S. congressional districts.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)    <span class="co"># For HTTP requests</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)    <span class="co"># For formatted strings</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fs)      <span class="co"># For file and directory handling</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)    <span class="co"># For parsing HTML content</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)   <span class="co"># For web scraping</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rvest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    guess_encoding</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define base URL and create download directory</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>base_url <span class="ot">&lt;-</span> <span class="st">"https://www2.census.gov/geo/tiger/TIGER{year}/CD/"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>download_dir <span class="ot">&lt;-</span> <span class="st">"data/congress_shapefiles"</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir_exists</span>(download_dir)) <span class="fu">dir_create</span>(download_dir)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the years corresponding to each Congress session (2014-2022)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2014</span>, <span class="dv">2022</span>, <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to download and extract shapefiles for each year</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (year <span class="cf">in</span> years) {</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  year_url <span class="ot">&lt;-</span> <span class="fu">glue</span>(base_url, <span class="at">year =</span> year)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Get list of zip files available for each year</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">read_html</span>(year_url)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Could not access:"</span>, year_url, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If the page was successfully accessed, proceed</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(page)) {</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get links to all zip files in the directory</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    zip_files <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> <span class="fu">html_nodes</span>(<span class="st">"a"</span>) <span class="sc">%&gt;%</span> <span class="fu">html_attr</span>(<span class="st">"href"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                 .[<span class="fu">grepl</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">.zip$"</span>, .)]</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Download each zip file</span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (zip_file <span class="cf">in</span> zip_files) {</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>      file_name <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"congress_{year}_{zip_file}"</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>      file_path <span class="ot">&lt;-</span> <span class="fu">path</span>(download_dir, file_name)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>      file_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(year_url, zip_file)</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Download only if the file does not already exist</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file_exists</span>(file_path)) {</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Downloading:"</span>, file_url, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        <span class="fu">GET</span>(file_url, <span class="fu">write_disk</span>(file_path, <span class="at">overwrite =</span> <span class="cn">TRUE</span>))</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Extract the .shp file from the zip</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>        extracted_dir <span class="ot">&lt;-</span> <span class="fu">path</span>(download_dir, <span class="fu">glue</span>(<span class="st">"congress_{year}"</span>))</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir_exists</span>(extracted_dir)) <span class="fu">dir_create</span>(extracted_dir)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unzip</span>(file_path, <span class="at">exdir =</span> extracted_dir)</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"Extracted shapefiles for Congress session:"</span>, year, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">"File already exists:"</span>, file_name, <span class="st">"- Skipping download.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>File already exists: congress_2014_tl_2014_us_cd114.zip - Skipping download.
File already exists: congress_2016_tl_2016_us_cd115.zip - Skipping download.
File already exists: congress_2018_tl_2018_us_cd116.zip - Skipping download.
File already exists: congress_2020_tl_2020_us_cd116.zip - Skipping download.
File already exists: congress_2022_tl_2022_01_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_02_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_04_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_05_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_06_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_08_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_09_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_10_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_11_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_12_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_13_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_15_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_16_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_17_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_18_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_19_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_20_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_21_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_22_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_23_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_24_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_25_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_26_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_27_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_28_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_29_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_30_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_31_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_32_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_33_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_34_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_35_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_36_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_37_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_38_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_39_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_40_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_41_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_42_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_44_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_45_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_46_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_47_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_48_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_49_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_50_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_51_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_53_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_54_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_55_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_56_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_60_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_66_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_69_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_72_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_78_cd118.zip - Skipping download.
File already exists: congress_2022_tl_2022_us_cd116.zip - Skipping download.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"All congressional shapefiles processed successfully.</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>All congressional shapefiles processed successfully.</code></pre>
</div>
</div>
</section>
<section id="task-3-exploration-of-vote-count-data" class="level2">
<h2 class="anchored" data-anchor-id="task-3-exploration-of-vote-count-data">Task 3: Exploration Of Vote Count Data</h2>
<p>This task will require to go back to data we intially downloaded at the start of this report to answer several questions regarding the House of Representatives, the fusion system, and presidential candidate trends in different states.</p>
</section>
<section id="which-states-have-gained-and-lost-the-most-seats-in-the-us-house-of-representatives-between-1976-and-2022" class="level2">
<h2 class="anchored" data-anchor-id="which-states-have-gained-and-lost-the-most-seats-in-the-us-house-of-representatives-between-1976-and-2022">1. Which states have gained and lost the most seats in the US House of Representatives between 1976 and 2022?</h2>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  house_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"1976-2022-house.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 32452 Columns: 20</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (7): state, state_po, office, stage, candidate, party, mode
dbl (8): year, state_fips, state_cen, state_ic, district, candidatevotes, to...
lgl (5): runoff, special, writein, unofficial, fusion_ticket

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count unique districts per state and year</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>district_counts <span class="ot">&lt;-</span> house_data <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(district)) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">num_districts =</span> <span class="fu">n_distinct</span>(district), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get counts for 1976 and 2022</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>district_counts_1976 <span class="ot">&lt;-</span> district_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">1976</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(state, num_districts)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>district_counts_2022 <span class="ot">&lt;-</span> district_counts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(state, num_districts)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate change in seats from 1976 to 2022</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>seat_changes <span class="ot">&lt;-</span> district_counts_2022 <span class="sc">%&gt;%</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">num_districts_2022 =</span> num_districts) <span class="sc">%&gt;%</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(district_counts_1976, <span class="at">by =</span> <span class="st">"state"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">"_2022"</span>, <span class="st">"_1976"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">seat_change =</span> num_districts_2022 <span class="sc">-</span> num_districts) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(seat_change))</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Top 5 states with most gain and most loss in seats</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>seat_changes_top_gain_loss <span class="ot">&lt;-</span> seat_changes <span class="sc">%&gt;%</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, (<span class="fu">n</span>()<span class="sc">-</span><span class="dv">4</span>)<span class="sc">:</span><span class="fu">n</span>()))</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result as a formatted table</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(seat_changes_top_gain_loss, <span class="at">caption =</span> <span class="st">"Top 5 States with Most Gains and Losses in House Seats (1976-2022)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Top 5 States with Most Gains and Losses in House Seats (1976-2022)</caption>
<thead>
<tr class="header">
<th style="text-align: left;">state</th>
<th style="text-align: right;">num_districts_2022</th>
<th style="text-align: right;">num_districts</th>
<th style="text-align: right;">seat_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">TEXAS</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">FLORIDA</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARIZONA</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GEORGIA</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">MICHIGAN</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">-6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ILLINOIS</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">-7</td>
</tr>
<tr class="even">
<td style="text-align: left;">OHIO</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">-8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PENNSYLVANIA</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-8</td>
</tr>
<tr class="even">
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">-13</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="new-york-state-has-a-unique-fusion-voting-system-where-one-candidate-can-appear-on-multiple-lines-on-the-ballot-and-their-vote-counts-are-totaled.-for-instance-in-2022-jerrold-nadler-appeared-on-both-the-democrat-and-working-families-party-lines-for-nys-12th-congressional-district.-he-received-200890-votes-total-184872-as-a-democrat-and-16018-as-wfp-easily-defeating-michael-zumbluskas-who-received-44173-votes-across-three-party-lines-republican-conservative-and-parent.are-there-any-elections-in-our-data-where-the-election-would-have-had-a-different-outcome-if-the-fusion-system-was-not-used-and-candidates-only-received-the-votes-their-received-from-their-major-party-line-democrat-or-republican-and-not-their-total-number-of-votes-across-all-lines" class="level2">
<h2 class="anchored" data-anchor-id="new-york-state-has-a-unique-fusion-voting-system-where-one-candidate-can-appear-on-multiple-lines-on-the-ballot-and-their-vote-counts-are-totaled.-for-instance-in-2022-jerrold-nadler-appeared-on-both-the-democrat-and-working-families-party-lines-for-nys-12th-congressional-district.-he-received-200890-votes-total-184872-as-a-democrat-and-16018-as-wfp-easily-defeating-michael-zumbluskas-who-received-44173-votes-across-three-party-lines-republican-conservative-and-parent.are-there-any-elections-in-our-data-where-the-election-would-have-had-a-different-outcome-if-the-fusion-system-was-not-used-and-candidates-only-received-the-votes-their-received-from-their-major-party-line-democrat-or-republican-and-not-their-total-number-of-votes-across-all-lines">2 New York State has a unique “fusion” voting system where one candidate can appear on multiple “lines” on the ballot and their vote counts are totaled. For instance, in 2022, Jerrold Nadler appeared on both the Democrat and Working Families party lines for NYS’ 12th Congressional District. He received 200,890 votes total (184,872 as a Democrat and 16,018 as WFP), easily defeating Michael Zumbluskas, who received 44,173 votes across three party lines (Republican, Conservative, and Parent).Are there any elections in our data where the election would have had a different outcome if the “fusion” system was not used and candidates only received the votes their received from their “major party line” (Democrat or Republican) and not their total number of votes across all lines?</h2>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>house_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"1976-2022-house.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 32452 Columns: 20
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (7): state, state_po, office, stage, candidate, party, mode
dbl (8): year, state_fips, state_cen, state_ic, district, candidatevotes, to...
lgl (5): runoff, special, writein, unofficial, fusion_ticket

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify major party lines (Democrat and Republican) for all states</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>house_data <span class="ot">&lt;-</span> house_data <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_major_party =</span> <span class="fu">ifelse</span>(party <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"DEMOCRAT"</span>, <span class="st">"REPUBLICAN"</span>), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate votes by candidate across all lines and calculate total and major-only votes</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>total_votes_by_candidate <span class="ot">&lt;-</span> house_data <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state, district, candidate, party) <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_votes =</span> <span class="fu">sum</span>(candidatevotes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">major_party_votes =</span> <span class="fu">sum</span>(candidatevotes[is_major_party], <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if aggregation resulted in any data</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(total_votes_by_candidate) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"No aggregated vote data available for the specified candidates."</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify potential outcome changes across all states</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>outcome_changes <span class="ot">&lt;-</span> total_votes_by_candidate <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state, district) <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(total_votes)) <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">winner_total =</span> candidate[<span class="fu">which.max</span>(total_votes)],</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">winner_major_only =</span> candidate[<span class="fu">which.max</span>(major_party_votes)],</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">outcome_change =</span> winner_total <span class="sc">!=</span> winner_major_only) <span class="sc">%&gt;%</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, state, district, candidate, party, total_votes, major_party_votes, winner_total, winner_major_only, outcome_change)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Sub-sample the result for a more manageable display size </span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>outcome_changes_sample <span class="ot">&lt;-</span> outcome_changes <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">50</span>)</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result as a table with all necessary details</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(outcome_changes_sample, <span class="at">caption =</span> <span class="st">"Comparison of Presidential and Congressional Votes by State, Year, and Party (including outcome changes)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparison of Presidential and Congressional Votes by State, Year, and Party (including outcome changes)</caption>
<colgroup>
<col style="width: 2%">
<col style="width: 8%">
<col style="width: 4%">
<col style="width: 13%">
<col style="width: 16%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">state</th>
<th style="text-align: right;">district</th>
<th style="text-align: left;">candidate</th>
<th style="text-align: left;">party</th>
<th style="text-align: right;">total_votes</th>
<th style="text-align: right;">major_party_votes</th>
<th style="text-align: left;">winner_total</th>
<th style="text-align: left;">winner_major_only</th>
<th style="text-align: left;">outcome_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">VIRGINIA</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">GERALD E CONNOLLY</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">111720</td>
<td style="text-align: right;">111720</td>
<td style="text-align: left;">GERALD E CONNOLLY</td>
<td style="text-align: left;">GERALD E CONNOLLY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">KENTUCKY</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">ED WHITFIELD</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">132115</td>
<td style="text-align: right;">132115</td>
<td style="text-align: left;">ED WHITFIELD</td>
<td style="text-align: left;">ED WHITFIELD</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2022</td>
<td style="text-align: left;">MASSACHUSETTS</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">JAMES P MCGOVERN</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">180639</td>
<td style="text-align: right;">180639</td>
<td style="text-align: left;">JAMES P MCGOVERN</td>
<td style="text-align: left;">JAMES P MCGOVERN</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2014</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">ELISE M STEFANIK</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">79615</td>
<td style="text-align: right;">79615</td>
<td style="text-align: left;">ELISE M STEFANIK</td>
<td style="text-align: left;">ELISE M STEFANIK</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">ELISE M STEFANIK</td>
<td style="text-align: left;">CONSERVATIVE</td>
<td style="text-align: right;">15526</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">ELISE M STEFANIK</td>
<td style="text-align: left;">ELISE M STEFANIK</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2022</td>
<td style="text-align: left;">NORTH CAROLINA</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">COURTNEY GEELS</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">96442</td>
<td style="text-align: right;">96442</td>
<td style="text-align: left;">VALERIE P FOUSHEE</td>
<td style="text-align: left;">VALERIE P FOUSHEE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">NANCY PELOSI</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">120633</td>
<td style="text-align: right;">120633</td>
<td style="text-align: left;">NANCY PELOSI</td>
<td style="text-align: left;">NANCY PELOSI</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">RHODE ISLAND</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">RONALD K MACHTLEY</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">89963</td>
<td style="text-align: right;">89963</td>
<td style="text-align: left;">RONALD K MACHTLEY</td>
<td style="text-align: left;">RONALD K MACHTLEY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">IDAHO</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">LARRY LAROCCO</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">85054</td>
<td style="text-align: right;">85054</td>
<td style="text-align: left;">LARRY LAROCCO</td>
<td style="text-align: left;">LARRY LAROCCO</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">WISCONSIN</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">BLANK VOTE/SCATTERING</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">PAUL RYAN</td>
<td style="text-align: left;">PAUL RYAN</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">KENTUCKY</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">FLOYD G POORE</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">86890</td>
<td style="text-align: right;">86890</td>
<td style="text-align: left;">JIM BUNNING</td>
<td style="text-align: left;">JIM BUNNING</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1978</td>
<td style="text-align: left;">OHIO</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">JAMES L BAUMANN</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">61698</td>
<td style="text-align: right;">61698</td>
<td style="text-align: left;">SAMUEL L DEVINE</td>
<td style="text-align: left;">SAMUEL L DEVINE</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: right;">24</td>
<td style="text-align: left;">ED HARRISON</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">58062</td>
<td style="text-align: right;">58062</td>
<td style="text-align: left;">MARTIN FROST</td>
<td style="text-align: left;">MARTIN FROST</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">PENNSYLVANIA</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">JAY RUSSELL</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">7925</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">JAMES C GREENWOOD</td>
<td style="text-align: left;">JAMES C GREENWOOD</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">JUSTIN RAIMONDO</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">2904</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">PHILLIP BURTON</td>
<td style="text-align: left;">PHILLIP BURTON</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">ALABAMA</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">GERALD “GERRY” WALLACE</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">74145</td>
<td style="text-align: right;">74145</td>
<td style="text-align: left;">ROBERT E “BUD” CRAMER JR</td>
<td style="text-align: left;">ROBERT E “BUD” CRAMER JR</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2022</td>
<td style="text-align: left;">NEW MEXICO</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">YVETTE HERRELL</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">95636</td>
<td style="text-align: right;">95636</td>
<td style="text-align: left;">GABRIEL VASQUEZ</td>
<td style="text-align: left;">GABRIEL VASQUEZ</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2018</td>
<td style="text-align: left;">WYOMING</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">RICHARD BRUBAKER</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">6918</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">LIZ CHENEY</td>
<td style="text-align: left;">LIZ CHENEY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">ARIZONA</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">HARRY W BRAUN III</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">45609</td>
<td style="text-align: right;">45609</td>
<td style="text-align: left;">JOHN MCCAIN</td>
<td style="text-align: left;">JOHN MCCAIN</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">WEST VIRGINIA</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">NICK J RAHALL II</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">146807</td>
<td style="text-align: right;">146807</td>
<td style="text-align: left;">NICK J RAHALL II</td>
<td style="text-align: left;">NICK J RAHALL II</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2022</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: right;">37</td>
<td style="text-align: left;">CLARK PATTERSON</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">6332</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">LLOYD DOGGETT</td>
<td style="text-align: left;">LLOYD DOGGETT</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">ILLINOIS</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">MATTHEW JOSEPH BEAUCHAMP</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">1608</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">JESSE L JACKSON JR</td>
<td style="text-align: left;">JESSE L JACKSON JR</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2006</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">MARTIN W BLESSINGER</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">48121</td>
<td style="text-align: right;">48121</td>
<td style="text-align: left;">CAROLYN MCCARTHY</td>
<td style="text-align: left;">CAROLYN MCCARTHY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">VANESSA FOSTER</td>
<td style="text-align: left;">GREEN</td>
<td style="text-align: right;">1743</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">AL GREEN</td>
<td style="text-align: left;">AL GREEN</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">TENNESSEE</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">DAVID L WARD</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">6930</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">JOHN S TANNER</td>
<td style="text-align: left;">JOHN S TANNER</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">FRANCIS A GIROUX</td>
<td style="text-align: left;">RIGHT TO LIFE</td>
<td style="text-align: right;">5051</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">JOHN E SWEENY</td>
<td style="text-align: left;">JOHN E SWEENY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">KIRSTEN OLSEN</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">37009</td>
<td style="text-align: right;">37009</td>
<td style="text-align: left;">PAUL N “PETE” MCCLOSKEY JR</td>
<td style="text-align: left;">PAUL N “PETE” MCCLOSKEY JR</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">NEW JERSEY</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">SHAWN GIANELLA</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">386</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">MIKE FERGUSON</td>
<td style="text-align: left;">MIKE FERGUSON</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1998</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">13</td>
<td style="text-align: left;">ANITA LERMAN</td>
<td style="text-align: left;">INDEPENDENCE</td>
<td style="text-align: right;">1245</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">VITO FOSSELLA</td>
<td style="text-align: left;">VITO FOSSELLA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">MINNESOTA</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">BILL LUTHER</td>
<td style="text-align: left;">DEMOCRATIC-FARMER-LABOR</td>
<td style="text-align: right;">176340</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">BILL LUTHER</td>
<td style="text-align: left;">JOHN KLINE</td>
<td style="text-align: left;">TRUE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">JOHN PLACE</td>
<td style="text-align: left;">REFORM</td>
<td style="text-align: right;">6354</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">ELLEN O TAUSCHER</td>
<td style="text-align: left;">ELLEN O TAUSCHER</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">JERROLD NADLER</td>
<td style="text-align: left;">WORKING FAMILIES</td>
<td style="text-align: right;">6742</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">JERROLD NADLER</td>
<td style="text-align: left;">JERROLD NADLER</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">26</td>
<td style="text-align: left;">RONDA BALDWIN-KENNEDY</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">135877</td>
<td style="text-align: right;">135877</td>
<td style="text-align: left;">JULIA BROWNLEY</td>
<td style="text-align: left;">JULIA BROWNLEY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1982</td>
<td style="text-align: left;">ILLINOIS</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">RICHARD D MURPHY</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">48268</td>
<td style="text-align: right;">48268</td>
<td style="text-align: left;">MARTIN A RUSSO</td>
<td style="text-align: left;">MARTIN A RUSSO</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">NEW JERSEY</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">ROBERT E ANDREWS</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">153525</td>
<td style="text-align: right;">153525</td>
<td style="text-align: left;">ROBERT E ANDREWS</td>
<td style="text-align: left;">ROBERT E ANDREWS</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">MASSACHUSETTS</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">JOHN F TIERNEY</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">180942</td>
<td style="text-align: right;">180942</td>
<td style="text-align: left;">JOHN F TIERNEY</td>
<td style="text-align: left;">JOHN F TIERNEY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1994</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">KEN BENTSEN</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">61959</td>
<td style="text-align: right;">61959</td>
<td style="text-align: left;">KEN BENTSEN</td>
<td style="text-align: left;">KEN BENTSEN</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">MICKEY LELAND</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">109626</td>
<td style="text-align: right;">109626</td>
<td style="text-align: left;">MICKEY LELAND</td>
<td style="text-align: left;">MICKEY LELAND</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">MISSISSIPPI</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">BILL MARCY</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">99160</td>
<td style="text-align: right;">99160</td>
<td style="text-align: left;">BENNIE G THOMPSON</td>
<td style="text-align: left;">BENNIE G THOMPSON</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2010</td>
<td style="text-align: left;">MICHIGAN</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">GLENN A WILSON</td>
<td style="text-align: left;">NO PARTY AFFILIATION</td>
<td style="text-align: right;">7847</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">DAN BENISHEK</td>
<td style="text-align: left;">DAN BENISHEK</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1976</td>
<td style="text-align: left;">PENNSYLVANIA</td>
<td style="text-align: right;">12</td>
<td style="text-align: left;">THEODORE L HUMES</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">58489</td>
<td style="text-align: right;">58489</td>
<td style="text-align: left;">JOHN P MURTHA</td>
<td style="text-align: left;">JOHN P MURTHA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1978</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">VIC FAZIO</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">87764</td>
<td style="text-align: right;">87764</td>
<td style="text-align: left;">VIC FAZIO</td>
<td style="text-align: left;">VIC FAZIO</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">FLORIDA</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">JACK MCLAIN</td>
<td style="text-align: left;">CONSTITUTION PARTY OF FLORIDA</td>
<td style="text-align: right;">5260</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">E CLAY SHAW JR</td>
<td style="text-align: left;">E CLAY SHAW JR</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1990</td>
<td style="text-align: left;">MISSOURI</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">IKE SKELTON</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">105527</td>
<td style="text-align: right;">105527</td>
<td style="text-align: left;">IKE SKELTON</td>
<td style="text-align: left;">IKE SKELTON</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">SOUTH CAROLINA</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">STEVE LEFEMINE</td>
<td style="text-align: left;">CONSTITUTION</td>
<td style="text-align: right;">4447</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">JOE WILSON</td>
<td style="text-align: left;">JOE WILSON</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">OHIO</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">BOB GIBBS</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">198221</td>
<td style="text-align: right;">198221</td>
<td style="text-align: left;">BOB GIBBS</td>
<td style="text-align: left;">BOB GIBBS</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">NORTH CAROLINA</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">ERIK ANDERSON</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">114314</td>
<td style="text-align: right;">114314</td>
<td style="text-align: left;">WALTER B JONES</td>
<td style="text-align: left;">WALTER B JONES</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">OHIO</td>
<td style="text-align: right;">16</td>
<td style="text-align: left;">RALPH REGULA</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">159314</td>
<td style="text-align: right;">159314</td>
<td style="text-align: left;">RALPH REGULA</td>
<td style="text-align: left;">RALPH REGULA</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">ALABAMA</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">BOB RILEY</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">98353</td>
<td style="text-align: right;">98353</td>
<td style="text-align: left;">BOB RILEY</td>
<td style="text-align: left;">BOB RILEY</td>
<td style="text-align: left;">FALSE</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">VOID VOTE</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">SEAN PATRICK MALONEY</td>
<td style="text-align: left;">SEAN PATRICK MALONEY</td>
<td style="text-align: left;">FALSE</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>##3 Do presidential candidates tend to run ahead of or run behind congressional candidates in the same state? That is, does a Democratic candidate for president tend to get more votes in a given state than all Democratic congressional candidates in the same state?</p>
<p>Does this trend differ over time? Does it differ across states or across parties? Are any presidents particularly more or less popular than their co-partisans?</p>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data files - update paths if needed</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>house_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"1976-2022-house.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 32452 Columns: 20
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (7): state, state_po, office, stage, candidate, party, mode
dbl (8): year, state_fips, state_cen, state_ic, district, candidatevotes, to...
lgl (5): runoff, special, writein, unofficial, fusion_ticket

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>president_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">file.path</span>(data_dir, <span class="st">"1976-2020-president.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4287 Columns: 15
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (6): state, state_po, office, candidate, party_detailed, party_simplified
dbl (7): year, state_fips, state_cen, state_ic, candidatevotes, totalvotes, ...
lgl (2): writein, notes

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new `party_detailed` column in `house_data` based on `party`</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>house_data <span class="ot">&lt;-</span> house_data <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">party_detailed =</span> party)  <span class="co"># Copy `party` values to a new `party_detailed` column</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate votes by year, state, and party_detailed for congressional data</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>house_data <span class="ot">&lt;-</span> house_data <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state, party_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_congress_votes =</span> <span class="fu">sum</span>(candidatevotes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate votes by year, state, and party_detailed for presidential data</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>president_data <span class="ot">&lt;-</span> president_data <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, state, party_detailed) <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_presidential_votes =</span> <span class="fu">sum</span>(candidatevotes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Join datasets by year, state, and party_detailed</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> house_data <span class="sc">%&gt;%</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(president_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"state"</span>, <span class="st">"party_detailed"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vote_difference =</span> total_presidential_votes <span class="sc">-</span> total_congress_votes)</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns for the table and arrange by year and state</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, state, party_detailed, total_presidential_votes, total_congress_votes, vote_difference) <span class="sc">%&gt;%</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year, state)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Sub-sample the result for a more manageable display size </span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>table_data_sample <span class="ot">&lt;-</span> table_data <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">50</span>)</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result as a formatted table</span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(table_data_sample, <span class="at">caption =</span> <span class="st">"Comparison of Presidential and Congressional Votes by State, Year, and Party (Detailed)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Comparison of Presidential and Congressional Votes by State, Year, and Party (Detailed)</caption>
<colgroup>
<col style="width: 5%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">year</th>
<th style="text-align: left;">state</th>
<th style="text-align: left;">party_detailed</th>
<th style="text-align: right;">total_presidential_votes</th>
<th style="text-align: right;">total_congress_votes</th>
<th style="text-align: right;">vote_difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">OREGON</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">4348</td>
<td style="text-align: right;">198</td>
<td style="text-align: right;">4150</td>
</tr>
<tr class="even">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">IOWA</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">13123</td>
<td style="text-align: right;">2359</td>
<td style="text-align: right;">10764</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">KANSAS</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">422636</td>
<td style="text-align: right;">366757</td>
<td style="text-align: right;">55879</td>
</tr>
<tr class="even">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">SOUTH CAROLINA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">865941</td>
<td style="text-align: right;">714191</td>
<td style="text-align: right;">151750</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">PENNSYLVANIA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">2239164</td>
<td style="text-align: right;">2154372</td>
<td style="text-align: right;">84792</td>
</tr>
<tr class="even">
<td style="text-align: right;">1976</td>
<td style="text-align: left;">WISCONSIN</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">1004987</td>
<td style="text-align: right;">760740</td>
<td style="text-align: right;">244247</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">ILLINOIS</td>
<td style="text-align: left;">SOCIALIST WORKERS</td>
<td style="text-align: right;">2132</td>
<td style="text-align: right;">8086</td>
<td style="text-align: right;">-5954</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">KENTUCKY</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">8856</td>
<td style="text-align: right;">5069</td>
<td style="text-align: right;">3787</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">ALABAMA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3705</td>
<td style="text-align: right;">15998</td>
<td style="text-align: right;">-12293</td>
</tr>
<tr class="even">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">NEW JERSEY</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">2148278</td>
<td style="text-align: right;">1821620</td>
<td style="text-align: right;">326658</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">MARYLAND</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">813827</td>
<td style="text-align: right;">856306</td>
<td style="text-align: right;">-42479</td>
</tr>
<tr class="even">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">VERMONT</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">275</td>
<td style="text-align: right;">90026</td>
<td style="text-align: right;">-89751</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">MARYLAND</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">876167</td>
<td style="text-align: right;">624021</td>
<td style="text-align: right;">252146</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">NEW JERSEY</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">30258</td>
<td style="text-align: right;">48419</td>
<td style="text-align: right;">-18161</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">OHIO</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">2148222</td>
<td style="text-align: right;">2033028</td>
<td style="text-align: right;">115194</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">VERMONT</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">119775</td>
<td style="text-align: right;">51977</td>
<td style="text-align: right;">67798</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">ARIZONA</td>
<td style="text-align: left;">SOCIALIST WORKERS</td>
<td style="text-align: right;">1100</td>
<td style="text-align: right;">2043</td>
<td style="text-align: right;">-943</td>
</tr>
<tr class="even">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">MASSACHUSETTS</td>
<td style="text-align: left;">CITIZENS</td>
<td style="text-align: right;">2056</td>
<td style="text-align: right;">3290</td>
<td style="text-align: right;">-1234</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">NEW YORK</td>
<td style="text-align: left;">FREEDOM</td>
<td style="text-align: right;">11393</td>
<td style="text-align: right;">39379</td>
<td style="text-align: right;">-27986</td>
</tr>
<tr class="even">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">ARIZONA</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">11301</td>
<td style="text-align: right;">9394</td>
<td style="text-align: right;">1907</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2012</td>
<td style="text-align: left;">MAINE</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">292276</td>
<td style="text-align: right;">265982</td>
<td style="text-align: right;">26294</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">INDIANA</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">1729519</td>
<td style="text-align: right;">1738745</td>
<td style="text-align: right;">-9226</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1976</td>
<td style="text-align: left;">NORTH DAKOTA</td>
<td style="text-align: left;">AMERICAN</td>
<td style="text-align: right;">3698</td>
<td style="text-align: right;">4600</td>
<td style="text-align: right;">-902</td>
</tr>
<tr class="even">
<td style="text-align: right;">1976</td>
<td style="text-align: left;">NEW JERSEY</td>
<td style="text-align: left;">SOCIALIST WORKERS</td>
<td style="text-align: right;">1184</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">854</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">WISCONSIN</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">551997</td>
<td style="text-align: right;">17689</td>
<td style="text-align: right;">534308</td>
</tr>
<tr class="even">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">MINNESOTA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">954173</td>
<td style="text-align: right;">905793</td>
<td style="text-align: right;">48380</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">UTAH</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">3375</td>
<td style="text-align: right;">3691</td>
<td style="text-align: right;">-316</td>
</tr>
<tr class="even">
<td style="text-align: right;">1992</td>
<td style="text-align: left;">VIRGINIA</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">363768</td>
<td style="text-align: right;">69068</td>
<td style="text-align: right;">294700</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">MISSISSIPPI</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">2809</td>
<td style="text-align: right;">9429</td>
<td style="text-align: right;">-6620</td>
</tr>
<tr class="even">
<td style="text-align: right;">1984</td>
<td style="text-align: left;">WASHINGTON</td>
<td style="text-align: left;">POPULIST</td>
<td style="text-align: right;">5724</td>
<td style="text-align: right;">6855</td>
<td style="text-align: right;">-1131</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">OHIO</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">2940044</td>
<td style="text-align: right;">2752111</td>
<td style="text-align: right;">187933</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">CALIFORNIA</td>
<td style="text-align: left;">NATURAL LAW</td>
<td style="text-align: right;">15403</td>
<td style="text-align: right;">126822</td>
<td style="text-align: right;">-111419</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">WEST VIRGINIA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">326541</td>
<td style="text-align: right;">415396</td>
<td style="text-align: right;">-88855</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">MISSISSIPPI</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">756764</td>
<td style="text-align: right;">806832</td>
<td style="text-align: right;">-50068</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">WISCONSIN</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">1630866</td>
<td style="text-align: right;">1566671</td>
<td style="text-align: right;">64195</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">SOUTH DAKOTA</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">32478</td>
<td style="text-align: right;">17263</td>
<td style="text-align: right;">15215</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">MASSACHUSETTS</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">22095</td>
<td style="text-align: right;">357800</td>
<td style="text-align: right;">-335705</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">NEVADA</td>
<td style="text-align: left;">NATURAL LAW</td>
<td style="text-align: right;">545</td>
<td style="text-align: right;">7755</td>
<td style="text-align: right;">-7210</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">RHODE ISLAND</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">225123</td>
<td style="text-align: right;">140270</td>
<td style="text-align: right;">84853</td>
</tr>
<tr class="even">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">WEST VIRGINIA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">341016</td>
<td style="text-align: right;">436616</td>
<td style="text-align: right;">-95600</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">12341</td>
<td style="text-align: right;">13961</td>
<td style="text-align: right;">-1620</td>
</tr>
<tr class="even">
<td style="text-align: right;">1996</td>
<td style="text-align: left;">FLORIDA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">2546870</td>
<td style="text-align: right;">2036620</td>
<td style="text-align: right;">510250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">ALASKA</td>
<td style="text-align: left;">GREEN</td>
<td style="text-align: right;">1058</td>
<td style="text-align: right;">11434</td>
<td style="text-align: right;">-10376</td>
</tr>
<tr class="even">
<td style="text-align: right;">2004</td>
<td style="text-align: left;">GEORGIA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">3085</td>
<td style="text-align: right;">77</td>
<td style="text-align: right;">3008</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1980</td>
<td style="text-align: left;">NEW JERSEY</td>
<td style="text-align: left;">SOCIALIST WORKERS</td>
<td style="text-align: right;">2198</td>
<td style="text-align: right;">1869</td>
<td style="text-align: right;">329</td>
</tr>
<tr class="even">
<td style="text-align: right;">2020</td>
<td style="text-align: left;">INDIANA</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">1242416</td>
<td style="text-align: right;">1194901</td>
<td style="text-align: right;">47515</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">TEXAS</td>
<td style="text-align: left;">DEMOCRAT</td>
<td style="text-align: right;">2352748</td>
<td style="text-align: right;">2735940</td>
<td style="text-align: right;">-383192</td>
</tr>
<tr class="even">
<td style="text-align: right;">1988</td>
<td style="text-align: left;">MISSOURI</td>
<td style="text-align: left;">REPUBLICAN</td>
<td style="text-align: right;">1084953</td>
<td style="text-align: right;">909599</td>
<td style="text-align: right;">175354</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2016</td>
<td style="text-align: left;">VIRGINIA</td>
<td style="text-align: left;">INDEPENDENT</td>
<td style="text-align: right;">54054</td>
<td style="text-align: right;">36580</td>
<td style="text-align: right;">17474</td>
</tr>
<tr class="even">
<td style="text-align: right;">2008</td>
<td style="text-align: left;">NORTH CAROLINA</td>
<td style="text-align: left;">LIBERTARIAN</td>
<td style="text-align: right;">25722</td>
<td style="text-align: right;">19605</td>
<td style="text-align: right;">6117</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"nyc_borough_boundaries.zip"</span>)){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(<span class="st">"https://data.cityofnewyork.us/api/geospatial/tqmj-j8zm?method=export&amp;format=Shapefile"</span>, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile=</span><span class="st">"nyc_borough_boundaries.zip"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="do">##-</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tempdir</span>(); </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>zip_contents <span class="ot">&lt;-</span> <span class="fu">unzip</span>(<span class="st">"nyc_borough_boundaries.zip"</span>, </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">exdir =</span> td)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>fname_shp <span class="ot">&lt;-</span> zip_contents[<span class="fu">grepl</span>(<span class="st">"shp$"</span>, zip_contents)]</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>nyc_sf <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(fname_shp)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>nyc_sf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -74.25559 ymin: 40.49613 xmax: -73.70001 ymax: 40.91553
Geodetic CRS:  WGS84(DD)
# A tibble: 5 × 5
  boro_code boro_name      shape_area shape_leng                        geometry
      &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;              &lt;MULTIPOLYGON [°]&gt;
1         3 Brooklyn      1934142776.    728147. (((-73.86327 40.58388, -73.863…
2         5 Staten Island 1623618684.    325910. (((-74.05051 40.56642, -74.050…
3         1 Manhattan      636646082.    360038. (((-74.01093 40.68449, -74.011…
4         2 Bronx         1187174772.    463181. (((-73.89681 40.79581, -73.896…
5         4 Queens        3041418004.    888197. (((-73.82645 40.59053, -73.826…</code></pre>
</div>
</div>
</section>
<section id="task-4-automate-zip-file-extraction-in-this-task-we-are-creating-a-reusable-function-read_shp_from_zip-to-efficiently-handle-shapefile-data-stored-within-zip-archives-above-.-rather-than-manually-unzipping-files-and-locating-shapefiles-this-function-automates-the-process-by-locating-extracting-and-seamlessly-loading." class="level2">
<h2 class="anchored" data-anchor-id="task-4-automate-zip-file-extraction-in-this-task-we-are-creating-a-reusable-function-read_shp_from_zip-to-efficiently-handle-shapefile-data-stored-within-zip-archives-above-.-rather-than-manually-unzipping-files-and-locating-shapefiles-this-function-automates-the-process-by-locating-extracting-and-seamlessly-loading.">Task 4: Automate Zip File Extraction In this task, we are creating a reusable function, read_shp_from_zip(), to efficiently handle shapefile data stored within zip archives above . Rather than manually unzipping files and locating shapefiles, this function automates the process by locating, extracting and seamlessly loading.</h2>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">"nyc_borough_boundaries.zip"</span>)){</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(<span class="st">"https://data.cityofnewyork.us/api/geospatial/tqmj-j8zm?method=export&amp;format=Shapefile"</span>, </span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">destfile=</span><span class="st">"nyc_borough_boundaries.zip"</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="do">##-</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function to read a shapefile directly from a zip archive</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>read_shp_from_zip <span class="ot">&lt;-</span> <span class="cf">function</span>(zip_file) {</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a temporary directory for unzipping</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  td <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># List contents of the zip file and find the .shp file</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  zip_contents <span class="ot">&lt;-</span> <span class="fu">unzip</span>(zip_file, <span class="at">list =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  shp_file <span class="ot">&lt;-</span> zip_contents<span class="sc">$</span>Name[<span class="fu">grepl</span>(<span class="st">"shp$"</span>, zip_contents<span class="sc">$</span>Name)]</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unzip only the .shp file into the temporary directory</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unzip</span>(zip_file, <span class="at">files =</span> shp_file, <span class="at">exdir =</span> td, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Construct path to the .shp file</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  shp_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(td, shp_file)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read the .shp file using read_sf from the sf package</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  sf_object <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(shp_path)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sf_object)</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the function to read the shapefile from the zip archive</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>nyc_sf <span class="ot">&lt;-</span> <span class="fu">read_shp_from_zip</span>(<span class="st">"nyc_borough_boundaries.zip"</span>)</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nyc_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 5 features and 4 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -74.25559 ymin: 40.49613 xmax: -73.70001 ymax: 40.91553
Geodetic CRS:  WGS84(DD)
# A tibble: 5 × 5
  boro_code boro_name      shape_area shape_leng                        geometry
      &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;              &lt;MULTIPOLYGON [°]&gt;
1         3 Brooklyn      1934142776.    728147. (((-73.86327 40.58388, -73.863…
2         5 Staten Island 1623618684.    325910. (((-74.05051 40.56642, -74.050…
3         1 Manhattan      636646082.    360038. (((-74.01093 40.68449, -74.011…
4         2 Bronx         1187174772.    463181. (((-73.89681 40.79581, -73.896…
5         4 Queens        3041418004.    888197. (((-73.82645 40.59053, -73.826…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(nyc_sf, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">geometry=</span>geometry)) <span class="sc">+</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(nyc_sf, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">geometry=</span>geometry, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> shape_area)) <span class="sc">+</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-5-chloropleth-visualization-of-the-2000-presidential-election-electoral-college-results" class="level2">
<h2 class="anchored" data-anchor-id="task-5-chloropleth-visualization-of-the-2000-presidential-election-electoral-college-results">Task 5 Chloropleth Visualization of the 2000 Presidential Election Electoral College Results</h2>
<p>Now using previous data extracted from the previously downloaded files as well as the newly acquired skill of creating a chloropleth map, let us now create a map based on the 2000 Presidential Election to further assist us in our fact check report.</p>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL and file path again for downloading</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>zip_url <span class="ot">&lt;-</span> <span class="st">"https://www2.census.gov/geo/tiger/GENZ2022/shp/cb_2022_us_state_20m.zip"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>zip_file <span class="ot">&lt;-</span> <span class="st">"us_states_shp.zip"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Delete any partial or corrupted download</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(zip_file)) {</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(zip_file)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the file again</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(zip_url, <span class="at">destfile =</span> zip_file, <span class="at">mode =</span> <span class="st">"wb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the zip file to a temporary directory</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(zip_file, <span class="at">exdir =</span> td)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">list.files</span>(td)  <span class="co"># Check the contents of the unzipped folder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "cb_2022_us_state_20m.cpg"                           
 [2] "cb_2022_us_state_20m.dbf"                           
 [3] "cb_2022_us_state_20m.prj"                           
 [4] "cb_2022_us_state_20m.shp"                           
 [5] "cb_2022_us_state_20m.shp.ea.iso.xml"                
 [6] "cb_2022_us_state_20m.shp.iso.xml"                   
 [7] "cb_2022_us_state_20m.shx"                           
 [8] "file77751ae1265"                                    
 [9] "file777ad3b768"                                     
[10] "geo_export_6d9331e5-c96e-4bb5-920b-4268adeb7506.cpg"
[11] "geo_export_6d9331e5-c96e-4bb5-920b-4268adeb7506.dbf"
[12] "geo_export_6d9331e5-c96e-4bb5-920b-4268adeb7506.prj"
[13] "geo_export_6d9331e5-c96e-4bb5-920b-4268adeb7506.shp"
[14] "geo_export_6d9331e5-c96e-4bb5-920b-4268adeb7506.shx"</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a temporary directory to store the extracted shapefiles</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>td <span class="ot">&lt;-</span> <span class="fu">tempdir</span>()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the path to the shapefile zip</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>zip_file <span class="ot">&lt;-</span> <span class="st">"us_states_shp.zip"</span>  <span class="co"># Make sure this zip file exists in the working directory</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Unzip the shapefile contents to the temporary directory</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="fu">unzip</span>(zip_file, <span class="at">exdir =</span> td)</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Click to Show/Hide Code"</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the path to the extracted .shp file</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>shp_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(td, <span class="st">"cb_2022_us_state_20m.shp"</span>)  <span class="co"># Adjust file name if needed</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the shapefile</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>us_states_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(shp_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `cb_2022_us_state_20m' from data source 
  `/private/var/folders/55/x9_x3zvj66q6mf2n12kmq6mm0000gn/T/Rtmp2Wr6uI/cb_2022_us_state_20m.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 52 features and 9 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: -179.1743 ymin: 17.91377 xmax: 179.7739 ymax: 71.35256
Geodetic CRS:  NAD83</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample election results data frame</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>election_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">state =</span> <span class="fu">c</span>(<span class="st">"Alabama"</span>, <span class="st">"Alaska"</span>, <span class="st">"Arizona"</span>, <span class="st">"Arkansas"</span>, <span class="st">"California"</span>, <span class="st">"Colorado"</span>, <span class="st">"Connecticut"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Delaware"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Idaho"</span>, <span class="st">"Illinois"</span>, <span class="st">"Indiana"</span>, <span class="st">"Iowa"</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Kansas"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Louisiana"</span>, <span class="st">"Maine"</span>, <span class="st">"Maryland"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"Michigan"</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Minnesota"</span>, <span class="st">"Mississippi"</span>, <span class="st">"Missouri"</span>, <span class="st">"Montana"</span>, <span class="st">"Nebraska"</span>, <span class="st">"Nevada"</span>, <span class="st">"New Hampshire"</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"New Jersey"</span>, <span class="st">"New Mexico"</span>, <span class="st">"New York"</span>, <span class="st">"North Carolina"</span>, <span class="st">"North Dakota"</span>, <span class="st">"Ohio"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Oklahoma"</span>, <span class="st">"Oregon"</span>, <span class="st">"Pennsylvania"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"South Carolina"</span>, <span class="st">"South Dakota"</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Tennessee"</span>, <span class="st">"Texas"</span>, <span class="st">"Utah"</span>, <span class="st">"Vermont"</span>, <span class="st">"Virginia"</span>, <span class="st">"Washington"</span>, <span class="st">"West Virginia"</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Wisconsin"</span>, <span class="st">"Wyoming"</span>),</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">party_winner =</span> <span class="fu">c</span>(<span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>,</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>, <span class="st">"Republican"</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>, <span class="st">"Democrat"</span>, <span class="st">"Republican"</span>, <span class="st">"Democrat"</span>,</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Republican"</span>)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Load U.S. state boundaries shapefile</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">"state"</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>))</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(ID))  <span class="co"># Use tools::toTitleCase for consistent state names</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the election results with the state boundaries</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>map_data <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(election_results, <span class="at">by =</span> <span class="st">"state"</span>)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors for each party</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>party_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Republican"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Democrat"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the choropleth map</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(map_data) <span class="sc">+</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> party_winner), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors, <span class="at">na.value =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"2000 U.S. Presidential Election Results by State"</span>,</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"States colored by winning party (Republican = red, Democrat = blue)"</span>,</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Winning Party"</span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task-6-advanced-chloropleth-visualization-of-electoral-college-results" class="level2">
<h2 class="anchored" data-anchor-id="task-6-advanced-chloropleth-visualization-of-electoral-college-results">Task 6 Advanced Chloropleth Visualization of Electoral College Results</h2>
<div class="cell">
<details class="code-fold">
<summary>Click to Show/Hide Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(maps)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrected sample data for 50 states across 5 election years</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust `party_winner` values to match actual data if available</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alabama"</span>, <span class="st">"Alaska"</span>, <span class="st">"Arizona"</span>, <span class="st">"Arkansas"</span>, <span class="st">"California"</span>, <span class="st">"Colorado"</span>, <span class="st">"Connecticut"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Delaware"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Idaho"</span>, <span class="st">"Illinois"</span>, <span class="st">"Indiana"</span>, <span class="st">"Iowa"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Kansas"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Louisiana"</span>, <span class="st">"Maine"</span>, <span class="st">"Maryland"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"Michigan"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Minnesota"</span>, <span class="st">"Mississippi"</span>, <span class="st">"Missouri"</span>, <span class="st">"Montana"</span>, <span class="st">"Nebraska"</span>, <span class="st">"Nevada"</span>, <span class="st">"New Hampshire"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"New Jersey"</span>, <span class="st">"New Mexico"</span>, <span class="st">"New York"</span>, <span class="st">"North Carolina"</span>, <span class="st">"North Dakota"</span>, <span class="st">"Ohio"</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Oklahoma"</span>, <span class="st">"Oregon"</span>, <span class="st">"Pennsylvania"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"South Carolina"</span>, <span class="st">"South Dakota"</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Tennessee"</span>, <span class="st">"Texas"</span>, <span class="st">"Utah"</span>, <span class="st">"Vermont"</span>, <span class="st">"Virginia"</span>, <span class="st">"Washington"</span>, <span class="st">"West Virginia"</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Wisconsin"</span>, <span class="st">"Wyoming"</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2004</span>, <span class="dv">2008</span>, <span class="dv">2012</span>, <span class="dv">2016</span>, <span class="dv">2020</span>)</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Create all combinations of states and years</span></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>election_results <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">state =</span> states, <span class="at">year =</span> years)</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign party winners randomly as a placeholder (replace with actual data)</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># For reproducibility</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>election_results<span class="sc">$</span>party_winner <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"Republican"</span>, <span class="st">"Democrat"</span>), <span class="fu">nrow</span>(election_results), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Load U.S. state boundaries and convert to sf object</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(maps<span class="sc">::</span><span class="fu">map</span>(<span class="st">"state"</span>, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="cn">TRUE</span>))</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>us_states <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span></span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(ID))  <span class="co"># Convert state names to title case for merging</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge election results with state boundaries</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>map_data <span class="ot">&lt;-</span> us_states <span class="sc">%&gt;%</span></span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(election_results, <span class="at">by =</span> <span class="st">"state"</span>)</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colors for each party</span></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>party_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Republican"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Democrat"</span> <span class="ot">=</span> <span class="st">"blue"</span>)</span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Create faceted map</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(map_data) <span class="sc">+</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> party_winner), <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> party_colors, <span class="at">na.value =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"U.S. Presidential Election Results by State (2004-2020)"</span>,</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Winning Party"</span></span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)  <span class="co"># Create a facet for each election year</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="task7-comparing-the-effects-of-ecv-allocation-rules" class="level2">
<h2 class="anchored" data-anchor-id="task7-comparing-the-effects-of-ecv-allocation-rules">Task7 Comparing the Effects of ECV Allocation Rules</h2>
<p>After analyzing historical voting data,I believe that the State-Wide Winner Take All method that we all currently use in the country actually gives a slight edge to Republican candidates.It generally favors candidates who can win swing states and is the least aligned with the popular vote, and Republicans have been winning.The National Proportional system is likely the fairest in terms of reflecting the popular vote directly. ##Task 7 Evaluating Fairness of ECV Allocation Schemes Based on our analysis, it is shown that the National Proportional System is the fairest allocation method for the Electoral College, aligning most closely with Senator Elizabeth Warren’s claim that the current system disadvantages voters in heavily populated states. Under the existing State-Wide Winner-Take-All system, the Electoral College disproportionately boosts the voices of voters in smaller states. This is because smaller states receive a minimum of three electoral votes regardless of population, giving each individual vote more weight compared to votes in heavily populated states. As a result, candidates can lose the national popular vote but still win the presidency, as seen in the 2000 and 2016 elections, where the winners (George W. Bush and Donald Trump) did not win the popular vote but won the electoral vote.</p>
<p>On the contrary, the National Proportional System allocates Electoral College Votes (ECVs) based directly on each candidate’s share of the national popular vote. This makes sure that ECV distribution reflects the actual voter preference nationwide. This system would prevent outcomes where the Electoral College diverges from the popular vote, promoting a fairer representation of voter intentions. For example, in the 2020 election, a proportional allocation would have still resulted in Joe Biden’s victory, based off his popular vote lead, while eliminating excess influence from swing states.</p>
<p>Based on the analysis, we rate Senator Warren’s claim as “Mostly True” on the PolitiFact Truth-O-Meter. The current system indeed disadvantages voters in larger, heavily populated states by concentrating influence in smaller or swing states. A National Proportional System would mitigate this issue by providing a more democratic and representative outcome, which closely goes along with Senator Warren’s perspective.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/mussakone\.github\.io\/STA9750-2024-FALL\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>